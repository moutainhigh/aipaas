allprojects{
    apply plugin: 'java'
    apply plugin: 'eclipse'
    apply plugin: 'maven-publish'

    ext {
		moduleVersion = version != "unspecified"?version:'0.3.6'
		moduleMode = project.hasProperty('mode') ? project.getProperty('mode') : 'R'
		if(moduleMode == 'S'){
			moduleVersion = moduleVersion + "-SNAPSHOT";
		}
        publishUserName = "devadm"
        publishUserPassword = "Devadm@1212"
		publishSnapShotsURL="http://10.1.228.199:18081/nexus/content/repositories/snapshots/"
		publishReleaseURL="http://10.1.228.199:18081/nexus/content/repositories/releases/"
        builtBy="gradle 2.1"
    }

    compileJava.dependsOn clean
    sourceCompatibility = 1.7

    configurations.all {
        resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
    }
    group = 'com.ai'
}

subprojects{
    [compileJava, compileTestJava,javadoc]*.options*.encoding = 'UTF-8'

    repositories {
        maven{ url "http://10.1.228.199:18081/nexus/content/groups/public/"  }
    }

    dependencies{
        compile 'com.ai:ipaas-common:0.3'
        testCompile(
                "org.springframework:spring-test:4.1.5.RELEASE",
                "junit:junit:4.11"
        )

        testCompile  ('org.apache.jmeter:ApacheJMeter_junit:2.13'){
            exclude group: 'commons-math3', module: 'commons-math3'
            exclude group: 'commons-pool2', module: 'commons-pool2'
			exclude group: 'xerces', module: 'xercesImpl'
        }

    }

}

project("sdk-mcs-base"){
    project.ext {
        moduleName = "ipaas-mcs-base"
    }

    jar {
        baseName moduleName
        version moduleVersion
        include 'com/ai/paas/ipaas/mcs/**'
        manifest {
            attributes 'packageName': moduleName, 'Built-By': builtBy,'create-date': new Date().format('yyyy-MM-dd HH:mm:ss')
        }
    }

	task sourcesJar(type: Jar, dependsOn: classes) {
		baseName moduleName
	    version moduleVersion
	    classifier = 'sources'
	    from sourceSets.main.allSource
	}
	javadoc {
		exclude               "**/internal/**"
		failOnError				false
		options.memberLevel = JavadocMemberLevel.PUBLIC
		
		options.addStringOption("Xdoclint", "none")
		
	}
	
	task javadocJar(type: Jar, dependsOn: javadoc) {
		baseName moduleName
		version moduleVersion
		classifier = 'javadoc'
	
		from javadoc.destinationDir
	}
	
	artifacts {
	    archives sourcesJar
		archives javadocJar
	}
    publish.dependsOn build
}

project("sdk-mcs-comp"){
    project.ext {
        moduleName = "ipaas-mcs-comp"
    }

    jar {
        baseName moduleName
        version moduleVersion
        include 'com/ai/paas/ipaas/mcs/**'
        manifest {
            attributes 'packageName': moduleName, 'Built-By': builtBy,'create-date': new Date().format('yyyy-MM-dd HH:mm:ss')
        }
    }

	task sourcesJar(type: Jar, dependsOn: classes) {
		baseName moduleName
	    version moduleVersion
	    classifier = 'sources'
	    from sourceSets.main.allSource
	}

	javadoc {
		exclude               "**/internal/**"
		failOnError				false
		options.memberLevel = JavadocMemberLevel.PUBLIC
		
		options.addStringOption("Xdoclint", "none")
		
	}
	
	task javadocJar(type: Jar, dependsOn: javadoc) {
		baseName moduleName
		version moduleVersion
		classifier = 'javadoc'
	
		from javadoc.destinationDir
	}
	
	artifacts {
	    archives sourcesJar
		archives javadocJar
	}
    publish.dependsOn build
}

project("sdk-mcs-srv"){
    project.ext {
        moduleName = "ipaas-mcs"
    }

    jar {
        baseName moduleName
        version moduleVersion
        include 'com/ai/paas/ipaas/mcs/**'
        manifest {
            attributes 'packageName': moduleName, 'Built-By': builtBy,'create-date': new Date().format('yyyy-MM-dd HH:mm:ss')
        }
    }

	task sourcesJar(type: Jar, dependsOn: classes) {
		baseName moduleName
	    version moduleVersion
	    classifier = 'sources'
	    from sourceSets.main.allSource
	}

	javadoc {
		exclude               "**/internal/**"
		failOnError				false
		options.memberLevel = JavadocMemberLevel.PUBLIC
		
		options.addStringOption("Xdoclint", "none")
		
	}
	
	task javadocJar(type: Jar, dependsOn: javadoc) {
		baseName moduleName
		version moduleVersion
		classifier = 'javadoc'
	
		from javadoc.destinationDir
	}
	
	
	artifacts {
	    archives sourcesJar
		archives javadocJar
	}
    publish.dependsOn build
}